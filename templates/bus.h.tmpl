{{define "bus_h"}}

// HEADER FILE
// Bus name is {{ .Bus.Name }}
// Bus type is {{ .Bus.Type }}
// Bus --> .NodeInterfaces() --> .SentMessages() --> .Signals()
// {{ range .Bus.NodeInterfaces }}
    // node interface number = {{ .Number }}
    // node = {{ .Node.ID }}
    {{ range .SentMessages }} // messages ID sent = {{ .ID }}: {{ .Name }}, 
        // signals size sent = {{ range .Signals }}
            // NameSignal {{ .Name }} {{range .AttributeAssignments }} {{ range .Entity.Enum.Values }}{{ .Name }} {{ end }} {{ end }}{{ end }}
    {{ end }}
{{ end }}
 
/**
 * This file was generated by GHESBORO OMAR!! impazzisco - version 0.1.
 */

#ifndef {{ .dbName | toUpper }}_H
#define {{ .dbName | toUpper }}_H

#ifdef __cplusplus
extern "C" {
#endif

#include <stdint.h>
#include <stdbool.h>
#include <stddef.h>

#ifndef EINVAL
#    define EINVAL 22
#endif

/* Frame ids. */{{ range .Bus.NodeInterfaces }}{{ range .SentMessages }}{{ if (ne .Name "") }}
#define {{ $.dbName | toUpper }}_{{ .Name }}_FRAME_ID ({{ .ID | toUint }}){{ end }}{{ end }}{{ end }}

/* Frame lengths in bytes. */{{ range .Bus.NodeInterfaces }}{{ range .SentMessages }}{{ if (ne .Name "") }}
#define {{ $.dbName | toUpper }}_{{ .Name }}_LENGTH ({{ .SizeByte | toUint }}){{ end }}{{ end }}{{ end }}

/* Extended or standard frame types. */{{ range .Bus.NodeInterfaces }}{{ range .SentMessages }}{{ if (ne .Name "") }}
#define {{ $.dbName | toUpper }}_{{ .Name }}_IS_EXTENDED ({{ .ID | isExtended }}){{ end }}{{ end }}{{ end }}

/* Frame cycle times in milliseconds. */{{ range .Bus.NodeInterfaces }}{{ range .SentMessages }}{{ if (ne .Name "") }}
#define {{ $.dbName | toUpper }}_{{ .Name }}_CYCLE_TIME_MS ({{ .CycleTime | toUint }}){{ end }}{{ end }}{{ end }}

/* Signal choices. */{{ range .Bus.NodeInterfaces }}{{ range .SentMessages }}{{ if (ne .Name "") }}{{ $messageName := .Name }}{{ range .Signals }}{{ $signalName := .Name }}{{range .AttributeAssignments }}{{ range .Entity.Enum.Values }}
#define {{ $.dbName | toUpper }}_{{ $messageName | toUpper }}_{{ $signalName | toUpper }}_{{ .Name | toUpper }}_CHOICE ({{ .Index }}u){{ end }}{{ end }}{{ end }}{{ end }}{{ end }}{{end}}

/* Frame Names. */

/* Signal Names. */

/* Struct */
/* Declarations */ 

{{ range .Bus.NodeInterfaces }}{{ range .SentMessages }}{{ if (ne .Name "") }}{{ $messageName := .Name }}
/* Signals in message {{ $messageName }} */
struct {{ $.dbName | toLower }}_{{ $messageName | toLower }}_t {
{{ range .Signals }}
    /**
     * Range: 
     * Scale: {{ .StartValue }}
     * Offset:
     */
    uint8_t {{ .Name | toLower }};
    {{ end }}
};
{{ end }}{{ end }}{{ end }}


#define BUS_NAME "{{ .Bus.Name }}"

// typedef struct for a message
typedef struct {
    int id;
} Message;

#ifdef __cplusplus
}
#endif

#endif
{{end}}